---
layout: post
title: 软件无线电安全研究工具
category: 信息安全
tags: SDR，GNU Radio
description: 节选于书籍《无线电安全攻防大揭秘》
---
>节选于书籍《无线电安全攻防大揭秘》

## 1 软件无线电技术
软件无线电技术，即Software Define Radio(SDR)，有时也成为Software Radio。
如图所示是典型的软件无线电处理流程图。为了理解无线电的软件模块，受限需要理解与其关联的硬件。在图中的接受路径上，能够看到有天线、RF前端、ADC和代码。ADC是一个连接连续的“Analog”自然世界和离散的“Digital”世界的桥梁。

　　　　　　　　　　　  ![2016-12-30-1](/public/img/2016-12-30-1.png)

ADC有两个主要特性：采样率和动态范围。采样率是ADC测量模拟信号的速度；动态范围是ADC区最小信号值和最大信号值的精读，这决定了ADC数字信号输出的比特数（位数）。例如，8位的AD转换器最多能代表256个信号层次，而16位的转换器能够代表65536个层次的信号。总的来说，ADC的物理特性和价格决定了采样率和动态范围。

1927年，出生于瑞典的物理和电子学家Harry Nyquist提出了如果想使AD转换没有混叠现象发生，那么采样率至少是目标型号带宽的2倍。这就是著名的奈奎斯特定律。

假设我们要处理一低通信号，信号带宽是0~fmax，按照奈奎斯特理论，采样率必须至少是2*fmax。如果ADC的采样率是20MHz，但是我们想收听92.1MHz的FM电台，该怎么办呢？答案是使用RF前端，接收机的RF前端能够把它接收到的高频信号下变频到一个低频段信号后输出。例如，如果能让RF前端吧90~100MHz频段内的信号下变频到0~10MHz低频段范围内，那么20MHz的ADC就能够排上用场了。

在大多数情况下，我们把RF前端当做一个信号控制的黑盒子，负责处理输入信号的中心频率，使信号在高频和低频之间转换。举一个具体的例子，一个调制解调器的调制模块能够把50~800MHz之间的6MHz带宽的信号下变频到一个中心频率是0Hz的信号输出。这个输出的中心频率通常称作中频（IF）。中频为0的接收机称为零中频接收机。随着射频芯片和ADC芯片越来越强大，零中频接收机也变得越来越常见。

其实，如果ADC的采样率相对于射频信号的频率差别不是很大的话，RF前端也能够被去掉。有一个GNU Radio用户已经成功地使用一个100英尺（1一英尺等于12英寸，和0.305米）的天线直接连接到20MHz采样率的ADC上收听到了AM（300KHz~3MHz）和短波（3~30MHz）广播。

上面图中的最后一个模块“Your Code Here!”，就是软件代码所在的部分。在广义的软件无线电概念中，软件代码值各种“可编程”的代码，不仅是运行在CPU上的代码，也包括DSP和FPGA上平台上的代码。但在本书中，主要指运心在CPU上的代码。因为CPU是最广泛使用的编程平台，运行在CPU上的软件无线电代码最方便移植。

### 1.1 SDR的强大能力
在互联网行业有句话：“Software is eating the world”。

这是网景公司的创始人马克·安德森（Marc Andreessen）说的。我想这句话不仅针对互联网公司，对整个工业界都是成立的。无线通信行业，有了SDR的进入，正在发生这快速的变化。

太早之前的故事，这里就不细说了，感兴趣的读者可以读一下维基百科中“Software Defined Radio”这一词条。2000年以后，推动SDR技术的两大功臣，是GNU Radio和USPR这对搭档。

USRP是2004年有Matt Ettus开发的，公司就命名为Ettus Research。在USRP出现之前，SDR都是基于一些价格十几万元人民币的PCI板卡。USRP 一下子把SDR的价格拉低到了几千元人民币。

GNU Radio最早出现在2001年，2004年重写了整个项目，配合USRP，实现了一套完整的软硬件平台。这对搭档从此书写了SDR的新历史，使SDR成为了真正普及的工具。

SDR可以极大的“放大”程序员的能力。

2009年，利用USRP，OpenBTS（http://openbts.org/)这个项目第一次用SDR实现了一真正能用的GSM基站。而且OpenBTShi开源的，使得每一个程序员只要有USRP，就可以搭建一个GSM小基站。后来，使用SDR来实现基站的尝试就一直没有停止过。2012年，著名的法国程序员Fabrice Bellard（http://www.bellard.org/)以一人之力，开发出了基于USRP+CPU结构的完整LTE基站的功能；而在传统的电信设备制造企业中，开发一个基站至少需要多个软硬件团队的相互配合。毫不夸张的说，Fabrice Bellard一个人相当于100个普通程序员的生产力。

### 1.2 SDR用途

由于软件无线电具有能有快速开发、迭代更新的特点，所以他特别适合用在一些定制化的应用中。例如：  

* 学生和研究人员用它来研究无线信号处理算法，研究新的通信协议。因为所有的通信协议，从上至下都是PC上的软件代码。你可以像使用普通代码一样快速自如地修改、编译和运行，可以灵活的在多个协议层之间相互操作。当你撰写学术论文时，这些真实的实验结果常常能够作为理论分析的强有力支撑。  
* 创业型小公司或者学校里做产品开发类项目的人员，通常用它来开发原型设备POC（Prototype of Concept）。比如做一个支持多种制式的家庭网关，因为所有的东西都是“软”的，所以开发起来非常快，出现问题也容易修改。  
* 用来高校里的教学用实验平台。比如做通信原理实验，现在大部分实验都是用MATLAB仿真来做的，当有了
GNU Radio后，你就可以看到真正的信号星座图、频率漂移现象。而且它可以是一个远程的平台，共很多学生同时使用。  
* 业余无线电爱好者，他们用GNU Radio来搭建自己的电台。还有些射电天文学的爱好者，利用SDR来搭建自己的射电天文台。2014年，有一个民间项目ISEE3 Reboot Project，利用USRP和GNU Radio，与一个已经发射到太空60年之久的ISEE3卫星通信，试图重启它的动力系统（http://spacecollege.org/isee3/）。  
* 黑客！这是SDR用户中很大的一个群体。安全公司以及政府的无线电监控部门、军方的实验室对此很有兴趣。目前SDR技术已经广泛地使用在各个频段，用于无线电信号监听、逆向分析、欺骗攻击、监控防御等。这也是本书的主题。

## 2 GNU Radio简介

上一节介绍了SDR。SDR的应用可以有很多种实现方式，GNU Radio是其中的一种。

GNU Radio是一套自由开源软件工具，它提供了各种信号的处理模块，可用于实现软件无线电系统。它可以外接一些低成本的射频硬件，从而真正的实现有线信号发射接收的完整系统；也可以在没有射频硬件的情况下，运行一些仿真程序。GNU Radio已经被广泛用于科研、商业应用和业余爱好者的活动中。

用手机操作系统来类比，手机可以有很多种操作系统，如ios、安卓、windows、linux；GNU Radio有点像安卓系统，提供了一套运行和开发的平台，屏蔽了底层硬件的细节，可以支持多种射频硬件，而且是完全开源的。

使用GNU Radio能做什么？

GNU Radio几乎能完成所有的 __无线处理功能__。






