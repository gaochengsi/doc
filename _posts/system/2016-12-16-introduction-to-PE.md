---
layout: post
title: 深入剖析Win32可移植可执行文件格式第一部分（原文：An In-Depth Look into the Win32 Portable Executable File Format）
category: 操作系统
tags: PE，Win32，exe，dll
description: PE文件介绍
---
>原文的一个翻译，译者：SmartTech。[原文地址](https://msdn.microsoft.com/en-us/magazine/bb985992.aspx)。

作者:Matt Pietrek  
本文假设你对C++和Win32平台熟悉

## 总结
对可移植执行体文件（PE）形式的好的一个理解会使得对操作系统有一个好的理解。如果你知道你的DLL和EXE文件中有些什么，那么你将是一个更有见识的程序员。这篇文章，也是两篇连载中的第一篇，着眼于在过去的几年间PE文件格式发生的改变，以及对其格式的一个概述。

这次更新之后，作者讨论了PE格式是如何满足.NET应用，PE文件部分，RVAs，数据路径，以及函数的引入。附录包含了一份相关镜像头结构和他们描述的清单。


## 正文
很久以前,我开始为Microsoft Systems Journal(现在的MSDN® Magazine)写文章,其中有一篇名为“探索PE文件内幕——Win32 可移植可执行文件格式之旅”的文章很受欢迎,大大超出了我的意料。直到现在,我还听说有人（甚至在Microsoft）仍然在使用那篇文章,它依旧被 收录在MSDN Library中。不幸的是,文章的最大问题是它们是静止的。但是Win32®的世界在这些年已经发生了很大的变化,因此那篇文章已经严重过时了。我要从本月开始用两部分系列的文章 来补救这种情况。

你可能想知道为什么要关注可执行文件的格式。答案永远是:操作系统的可执行文件格式和数据结构展现了操作系统内部许多信息。通过理解EXE和DLL的内部情况,你会发现你已经变成你周围一个更优秀的程序员。

当然,通过阅读 Microsoft 的 PECOFF 规范你可以获得许多我将要告诉你的内容。但是与大多数规范一样,它更注重完整性而不是可读性。在本文中,我把精力集中于解释整个主题中最重要的部分,同时填补那些并不适合出现在官方规范中的怎么样（How）以及为什么（Why）的问题。另外,在本文中我还会讲到一些非常有用的内容,它们并未出现在任何 Microsoft 官方文档中。

### 背景知识

让我先举一些例子来说明自从1994年我写那篇文章以来有关可执行文件方面都发生了哪些变化。由于16位Windows®已经成为历史,因此没有必要再与Win16的NE（New Executable）格式相比较了。另一个已经脱离人们视野的是Win32s®。在 Windows 3.1 上运行Win32 程序非常不稳定是最令人讨厌的事。




















